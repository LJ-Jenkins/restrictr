<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ensure list elements are of a specific size and recycle them if not — schema_recycle • restrictr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ensure list elements are of a specific size and recycle them if not — schema_recycle"><meta name="description" content="If any of the data-masked named expressions in ... are not the specified size,
then the object attempts to be recycled to the size specified in the expression.
.names and .size arguments can be used to check for given names and size of the
list. The checking of size and the recycling are from the vctrs
package (using vctrs::vec_size and vctrs::vec_recycle) and thus apply the
vctrs recycling rules."><meta property="og:description" content="If any of the data-masked named expressions in ... are not the specified size,
then the object attempts to be recycled to the size specified in the expression.
.names and .size arguments can be used to check for given names and size of the
list. The checking of size and the recycling are from the vctrs
package (using vctrs::vec_size and vctrs::vec_recycle) and thus apply the
vctrs recycling rules."><meta property="og:image" content="https://lj-jenkins.github.io/restrictr_test/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">restrictr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ensure list elements are of a specific size and recycle them if not</h1>

      <div class="d-none name"><code>schema_recycle.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>If any of the data-masked named expressions in <code>...</code> are not the specified size,
then the object attempts to be recycled to the size specified in the expression.
<code>.names</code> and <code>.size</code> arguments can be used to check for given names and size of the
list. The checking of size and the recycling are from the <a href="https://vctrs.r-lib.org/" class="external-link">vctrs</a>
package (using <a href="https://vctrs.r-lib.org/reference/vec_size.html" class="external-link">vctrs::vec_size</a> and <a href="https://vctrs.r-lib.org/reference/vec_recycle.html" class="external-link">vctrs::vec_recycle</a>) and thus apply the
<a href="https://vctrs.r-lib.org/reference/theory-faq-recycling.html" class="external-link">vctrs recycling rules</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">schema_recycle</span><span class="op">(</span><span class="va">.data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'list'</span></span>
<span><span class="fu">schema_recycle</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  .names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .error_call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>a list to check the lengths schema of.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>any number of <code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">data-masking</a></code> name-value pairs
to be evaluated using <code>.data</code> as a data-mask. Should follow the format of
<code>name = expected_size</code>, e.g, <code>var_x = 10L</code> or <code>var_x = var_y</code>.</p></dd>


<dt id="arg--names">.names<a class="anchor" aria-label="anchor" href="#arg--names"></a></dt>
<dd><p>optional character vector of names which must be
present in the data.frame/list.</p></dd>


<dt id="arg--size">.size<a class="anchor" aria-label="anchor" href="#arg--size"></a></dt>
<dd><p>optional scalar integerish value for the size that
the data.frame/list must have.</p></dd>


<dt id="arg--error-call">.error_call<a class="anchor" aria-label="anchor" href="#arg--error-call"></a></dt>
<dd><p>the call environment to use for the error (passed to <a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">rlang::abort</a>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>See also <a href="schema.html">schema</a> and schema_recycle,
as well as <a href="cast_if_not.html">cast_if_not</a> for a non-data-masked version of casting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># NB: Some of these examples are expected to produce an error. To</span></span></span>
<span class="r-in"><span><span class="co">#     prevent them from terminating a run with example() they are</span></span></span>
<span class="r-in"><span><span class="co">#     piped into a call to try().</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="st">"hi"</span>, z <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># li$x and li$y are recycled.</span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hi" "hi" "hi"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>z <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="font-weight: bold;">Caused by error in `schema_recycle()`</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `z = 5` for data mask `li`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Can't recycle `z` (size 2) to size 5.</span>
<span class="r-in"><span><span class="co"># =&gt; Error: Can't recycle `z` (size 2) to size 5.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"hi"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="font-weight: bold;">Caused by error in `schema_recycle()`</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `x = "hi"` for data mask `li`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size argument is not <span style="color: #0000BB;">&lt;numeric&gt;</span>: <span style="color: #0000BB;">&lt;character&gt;</span> given.</span>
<span class="r-in"><span><span class="co"># =&gt; Size argument for `z` is not numeric: class &lt;character&gt;.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># schema_recycle works sequentially with quosures, so references to objects will</span></span></span>
<span class="r-in"><span><span class="co"># be after they have been evaluated:</span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_size.html" class="external-link">vec_size</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_size.html" class="external-link">vec_size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hi" "hi"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, .size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="font-weight: bold;">Caused by error in `schema_recycle()`</span>.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Object `li` is of <span style="color: #0000BB;">vctrs</span> size `3`, not `5`.</span>
<span class="r-in"><span><span class="co"># =&gt; Error: Object `li` must have vctrs size `5`, not `3`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">schema_recycle</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, .names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"p"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="font-weight: bold;">Caused by error in `schema_recycle()`</span>.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Named element `p` not found in data mask `li`.</span>
<span class="r-in"><span><span class="co"># =&gt; Error: Names `p` not found in `li`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># injection and glue can be used to supply expressions, names, and messages:</span></span></span>
<span class="r-in"><span><span class="va">li</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, z <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_name</span> <span class="op">&lt;-</span> <span class="st">"x"</span></span></span>
<span class="r-in"><span><span class="fu">schema_recycle</span><span class="op">(</span><span class="va">li</span>, <span class="op">!</span><span class="op">!</span><span class="va">x_name</span> <span class="op">:=</span> <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">li</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">xg_name</span> <span class="op">&lt;-</span> <span class="st">"{x_name}"</span></span></span>
<span class="r-in"><span><span class="fu">schema_recycle</span><span class="op">(</span><span class="va">li</span>, <span class="op">{</span><span class="op">{</span> <span class="va">xg_name</span> <span class="op">}</span><span class="op">}</span> <span class="op">:=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="font-weight: bold;">Caused by error in `schema_recycle()`</span>:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `x = 10` for data mask `li`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Can't recycle `x` (size 2) to size 10.</span>
<span class="r-in"><span><span class="co"># =&gt; Error: Can't recycle `x` (size 2) to size 10.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke Jenkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

