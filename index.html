<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Function Argument Validation and Coercion • restrictr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Function Argument Validation and Coercion">
<meta name="description" content="Tools for function argument validation that focus on clear error messaging and include options for safe, automatic type casting and size recycling.">
<meta property="og:description" content="Tools for function argument validation that focus on clear error messaging and include options for safe, automatic type casting and size recycling.">
<meta property="og:image" content="https://lj-jenkins.github.io/restrictr_test/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">restrictr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="restrictr-">restrictr <a class="anchor" aria-label="anchor" href="#restrictr-"></a>
</h1>
</div>
<!-- badges: start -->

<p>restrictr has been superseded by <a href="https://github.com/LJ-Jenkins/favr" class="external-link">favr</a>. Please use favr instead of restrictr.</p>
<p>restrictr provides tools for the validation and safe type coercion/recycling of function arguments.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<ul>
<li>
<code><a href="reference/abort_if_not.html">abort_if_not()</a></code> for general validation.</li>
<li>
<code><a href="reference/cast_if_not.html">cast_if_not()</a></code> and <code><a href="reference/recycle_if_not.html">recycle_if_not()</a></code> for safe type casting and recycling of variables.</li>
<li>
<code><a href="reference/schema.html">schema()</a></code> for the validation of named elements of data.frames/lists.</li>
<li>
<code><a href="reference/schema_cast.html">schema_cast()</a></code> and <code><a href="reference/schema_recycle.html">schema_recycle()</a></code> for the safe type casting and recycling of named elements of data.frames/lists.</li>
<li>
<code><a href="reference/enforce_schema.html">enforce_schema()</a></code> to reapply the attached schema from the above functions.</li>
<li>
<code><a href="reference/restrict.html">restrict()</a></code> for validation, safe type casting and safe recycling of both variables and named elements of data.frames/lists.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of restrictr from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"LJ-Jenkins/restrictr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p><code>abort_if_not</code> can be used for all validations:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lj-jenkins.github.io/restrictr/" class="external-link">restrictr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/abort_if_not.html">abort_if_not</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    <span class="st">"`{x}` is too short!"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span>,</span>
<span>    <span class="va">y</span><span class="op">$</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fl">1L</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(tf, eval_env = eval_env, error_call = .error_call, : could not find function "glue_names"</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="st">"hi"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(tf, eval_env = eval_env, error_call = .error_call, : could not find function "glue_names"</span></span></code></pre></div>
<p><code>cast_if_not</code> and <code>recycle_if_not</code> provide safe casting and recycling from <a href="https://vctrs.r-lib.org/" class="external-link">vctrs</a>. Variables are provided on the left hand side and the expected type/size is provided on the right. Assignment is automatically done back into the environment specified (default is the <a href="https://rlang.r-lib.org/reference/stack.html" class="external-link">caller_env()</a>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/cast_if_not.html">cast_if_not</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="reference/recycle_if_not.html">recycle_if_not</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fl">5L</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(qs, eval_env = .env, error_call = .error_call, restrictr_fn = restrictr_fn): could not find function "glue_names"</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/cast_if_not.html">cast_if_not</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, .lossy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(qs, eval_env = .env, error_call = .error_call, restrictr_fn = restrictr_fn): could not find function "glue_names"</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="st">"hi"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(qs, eval_env = .env, error_call = .error_call, restrictr_fn = restrictr_fn): could not find function "glue_names"</span></span></code></pre></div>
<p><code>schema</code>, <code>schema_cast</code> and <code>schema_recycle</code> provide the same functionality for data-masked arguments from data.frames/lists. The size of the data.frame/list and whether certain names are present can also be checked using the <code>.names</code> and <code>.size</code> arguments. The altered data-mask object is returned with an attached class <code>with_schema</code> which is used by <code><a href="reference/enforce_schema.html">enforce_schema()</a></code> to reapply the original schema call:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/schema.html">schema</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in (function (cnd) : object 'j' not found</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/schema_cast.html">schema_cast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in schema_cast(df, x = double()): could not find function "schema_cast"</span></span>
<span></span>
<span><span class="co"># schema_recycle is only implemented for lists.</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">li</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">li</span> <span class="op">&lt;-</span> <span class="va">li</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="reference/schema_recycle.html">schema_recycle</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">5</span>, z <span class="op">=</span> <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_size.html" class="external-link">vec_size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">li</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, z <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in schema_recycle(li, x = 3, y = 5, z = vctrs::vec_size(x)): could not find function "schema_recycle"</span></span>
<span></span>
<span><span class="co"># enforce_schema reapplies the original call.</span></span>
<span><span class="va">li</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="st">"hi"</span><span class="op">)</span></span>
<span><span class="va">li_with_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/schema.html">schema</a></span><span class="op">(</span><span class="va">li</span>, <span class="va">x</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">li_with_schema</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="reference/enforce_schema.html">enforce_schema</a></span><span class="op">(</span><span class="va">li_with_schema</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in if (lhs == "") rhs else lhs: argument is of length zero</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df_with_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/schema_cast.html">schema_cast</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, .lossy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in schema_cast(df, x = integer(), .lossy = TRUE): could not find function "schema_cast"</span></span>
<span><span class="va">df_with_schema</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: object 'df_with_schema' not found</span></span>
<span></span>
<span><span class="fu"><a href="reference/enforce_schema.html">enforce_schema</a></span><span class="op">(</span><span class="va">df_with_schema</span><span class="op">)</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="co">#&gt; Error: object 'df_with_schema' not found</span></span>
<span></span>
<span><span class="va">li_with_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/schema_recycle.html">schema_recycle</a></span><span class="op">(</span><span class="va">li</span>, x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in schema_recycle(li, x = 2, y = 3): could not find function "schema_recycle"</span></span>
<span><span class="va">li_with_schema</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="st">"hi"</span></span>
<span></span>
<span><span class="fu"><a href="reference/enforce_schema.html">enforce_schema</a></span><span class="op">(</span><span class="va">li_with_schema</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="co">#&gt; [1] "hi"</span></span></code></pre></div>
<p><code>restrict</code> combines all functionality into a multi-purpose tool. Both variables and named elements within data.frames/lists can be validated and casted/recycled. They keyword functions of <code>validate</code>, <code>cast</code>, <code>lossy_cast</code>, <code>recycle</code> and <code>coerce</code> determines whether any type casting and/or recycling occurs. Validation functions can then be given, either in the form of functions or lambdas. Assignment occurs back into the environment specified (default is the <a href="https://rlang.r-lib.org/reference/stack.html" class="external-link">caller_env()</a>). A contradictory example just to show features:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">df</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/restrict.html">restrict</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="fu">validate</span><span class="op">(</span></span>
<span>      type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>      \<span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">==</span> <span class="st">"x"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu">cast</span><span class="op">(</span>type <span class="op">=</span> <span class="va">.env</span><span class="op">$</span><span class="va">x</span>, mask <span class="op">=</span> <span class="va">df</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="fu">coerce</span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span>, lossy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"`df$x` casted to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="st">"from the initial `x` class \n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"`x` lossily casted to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"and recycled using value of `df$x` to length"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(rargs, eval_env = .env, error_call = .error_call, : could not find function "glue_names"</span></span>
<span></span>
<span><span class="co">#-- vctrs type/size rules are for all `cast`, `recycle` and `coerce` calls within restrictr functions</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/restrict.html">restrict</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fu">validate</span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1L</span>, y <span class="op">=</span> <span class="st">"hi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(rargs, eval_env = .env, error_call = .error_call, : could not find function "glue_names"</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="reference/restrict.html">restrict</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">recycle</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(rargs, eval_env = .env, error_call = .error_call, : could not find function "glue_names"</span></span></code></pre></div>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<p>restrictr and <code>restrict</code> were inspired by MATLAB’s <a href="https://uk.mathworks.com/help/matlab/ref/arguments.html" class="external-link">arguments block</a>.</p>
<p>restrictr functions do not do any clean-up in the case of errors. As typical usage should be within functions, this should have little impact. However, if you intend to continue using the variables in the associated environments, care should be taken. See the following example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1L</span></span>
<span>  <span class="fu"><a href="reference/cast_if_not.html">cast_if_not</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">double</a></span><span class="op">(</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>    <span class="st">"Code has errored but `x` has still been casted to:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>    <span class="st">"in the environment specified for the `cast_if_not` call."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in glue_names(qs, eval_env = .env, error_call = .error_call, restrictr_fn = restrictr_fn) : </span></span>
<span><span class="co">#&gt;   could not find function "glue_names"</span></span>
<span><span class="co">#&gt; Code has errored but `x` has still been casted to: integer </span></span>
<span><span class="co">#&gt;  in the environment specified for the `cast_if_not` call.</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing restrictr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luke Jenkins <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7206-7242" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/LJ-Jenkins/restrictr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/LJ-Jenkins/restrictr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke Jenkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
